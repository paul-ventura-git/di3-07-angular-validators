<h2>Formulario con Validadores Asíncronos</h2>

<form [formGroup]="formulario" (ngSubmit)="enviarFormulario()">

  <!-- Nombre -->
  <label>Nombre:</label>
  <input type="text" formControlName="nombre" />
  <span *ngIf="formulario.get('nombre')?.invalid && formulario.get('nombre')?.touched">
    El nombre es obligatorio y debe tener mínimo 3 caracteres.
  </span>

  <!-- Email -->
  <label>Email:</label>
  <input type="email" formControlName="email" />
  <span *ngIf="formulario.get('email')?.pending">Verificando disponibilidad...</span>
  <span *ngIf="formulario.get('email')?.errors?.['emailNoDisponible']">El email ya está registrado.</span>

  <!-- Username -->
  <label>Username:</label>
  <input type="text" formControlName="username" />
  <span *ngIf="formulario.get('username')?.pending">Verificando disponibilidad...</span>
  <span *ngIf="formulario.get('username')?.errors?.['usernameNoDisponible']">El username ya está en uso.</span>

  <!-- Password -->
  <label>Password:</label>
  <input type="password" formControlName="password" />

  <!-- Confirm Password -->
  <label>Confirmar Password:</label>
  <input type="password" formControlName="confirmPassword" />
  <span *ngIf="formulario.errors?.['noCoincide'] && formulario.get('confirmPassword')?.touched">
    Las contraseñas no coinciden.
  </span>

  <button type="submit">Enviar</button>

  <pre>
  {{
    {
      formulario: {
        valid: formulario.valid,
        invalid: formulario.invalid,
        pending: formulario.pending,
        touched: formulario.touched,
        untouched: formulario.untouched,
        dirty: formulario.dirty,
        pristine: formulario.pristine,
        status: formulario.status
      },
      controles: {
        nombre: formulario.get('nombre'),
        email: formulario.get('email'),
        username: formulario.get('username'),
        password: formulario.get('password'),
        confirmPassword: formulario.get('confirmPassword')
      }
    }
    | json
  }}
  </pre>
</form>

