<h2>Formulario con Validadores Asíncronos</h2>

<form [formGroup]="formulario" (ngSubmit)="enviarFormulario()">

  <!-- Nombre -->
  <label>Nombre:</label>
  <input type="text" formControlName="nombre" />
  <span *ngIf="formulario.get('nombre')?.invalid && formulario.get('nombre')?.touched">
    El nombre es obligatorio y debe tener mínimo 3 caracteres.
  </span>

  <!-- Email -->
  <label>Email:</label>
  <input type="email" formControlName="email" />
  <span *ngIf="formulario.get('email')?.pending">Verificando disponibilidad...</span>
  <span *ngIf="formulario.get('email')?.errors?.['emailNoDisponible']">El email ya está registrado.</span>

  <!-- Username -->
  <label>Username:</label>
  <input type="text" formControlName="username" />
  <span *ngIf="formulario.get('username')?.pending">Verificando disponibilidad...</span>
  <span *ngIf="formulario.get('username')?.errors?.['usernameNoDisponible']">El username ya está en uso.</span>

  <!-- Password -->
  <label>Password:</label>
  <input type="password" formControlName="password" />

  <!-- Confirm Password -->
  <label>Confirmar Password:</label>
  <input type="password" formControlName="confirmPassword" />
  <span *ngIf="formulario.errors?.['noCoincide'] && formulario.get('confirmPassword')?.touched">
    Las contraseñas no coinciden.
  </span>

  <button type="submit">Enviar</button>

  <pre>
  {{
    {
      formulario: {
        value: formulario.value,
        valid: formulario.valid,
        invalid: formulario.invalid,
        pending: formulario.pending,
        touched: formulario.touched,
        untouched: formulario.untouched,
        dirty: formulario.dirty,
        pristine: formulario.pristine,
        status: formulario.status
      },
      controles: {
        nombre: {
          value: formulario.get('nombre')?.value,
          errors: formulario.get('nombre')?.errors,
          status: formulario.get('nombre')?.status,
          dirty: formulario.get('nombre')?.dirty,
          touched: formulario.get('nombre')?.touched,
          pristine: formulario.get('nombre')?.pristine,
          pending: formulario.get('nombre')?.pending
        },
        email: {
          value: formulario.get('email')?.value,
          errors: formulario.get('email')?.errors,
          status: formulario.get('email')?.status,
          dirty: formulario.get('email')?.dirty,
          touched: formulario.get('email')?.touched,
          pristine: formulario.get('email')?.pristine,
          pending: formulario.get('email')?.pending
        },
        username: {
          value: formulario.get('username')?.value,
          errors: formulario.get('username')?.errors,
          status: formulario.get('username')?.status,
          dirty: formulario.get('username')?.dirty,
          touched: formulario.get('username')?.touched,
          pristine: formulario.get('username')?.pristine,
          pending: formulario.get('username')?.pending
        },
        password: {
          value: formulario.get('password')?.value,
          errors: formulario.get('password')?.errors,
          status: formulario.get('password')?.status,
          dirty: formulario.get('password')?.dirty,
          touched: formulario.get('password')?.touched,
          pristine: formulario.get('password')?.pristine,
          pending: formulario.get('password')?.pending
        },
        confirmPassword: {
          value: formulario.get('confirmPassword')?.value,
          errors: formulario.get('confirmPassword')?.errors,
          status: formulario.get('confirmPassword')?.status,
          dirty: formulario.get('confirmPassword')?.dirty,
          touched: formulario.get('confirmPassword')?.touched,
          pristine: formulario.get('confirmPassword')?.pristine,
          pending: formulario.get('confirmPassword')?.pending
        }
      }
    }
    | json
  }}
  </pre>
</form>

